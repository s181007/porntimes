<html>

<head>
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>恋声</title>
</head>

<body background="sakura_side.gif">

<h2><img border="0" src="koigoe.gif" width="32" height="32">　<font color="#FF0000">恋声</font></h2>   

<hr>
<p><a href="koigoe1.html">概要</a>　　　TD-PSOLA画面　　　<a href="koigoe3.html">Phase Vocoder画面</a>　　　<a href="koigoe4.html">Sound       
Effect画面</a>　　　<a href="koigoe6.html">設定画面</a>　　　<a href="koigoe5.html">問題と対策</a></p>
<hr>
<h2>TD-PSOLA画面</h2>

<p>　<font color="#FF0000"><b>「恋声」</b></font>のTD-PSOLA選択時の表示画面
<p><img border="0" src="TD-PSOLA.png" width="886" height="386"><p><br>
<b>【使い方１ 〜マイク入力の場合〜】</b><br>
<br>
　まず、PCにマイクとヘッドフォンを装着して下さい。<br>
　次に、Windowsのマイクの設定を行って下さい。（最初はWindowsの設定です。「恋声」はまだ起動しません。）<br>
<br>
(WindowsXPの場合）<br>
・録音コントロールを開いて、マイクの選択をチェックする。（マイクの表示がない場合にはオプション→プロパティ→録音で、マイクにチェックを入れる）<br>
・上の画面にあるボリュームのコントロールは、「恋声」を実行後にボリューム調整のために使用するので下の作業が終わったらまた開いておく。<br>
・再生コントロールを開いて、入力モニタのミュートにチェックを入れる。（入力モニタの表示がない場合にはオプション→プロパティ→再生で、入力モニタにチェックを入れる）<br>
・この状態でマイクに向かって話した声がヘッドフォンから聴こえないことを確認して下さい。（聴こえたらミュートがされていない）<br>
<br>
(WindowsVistaの場合）<br>
・録音デバイスのプロパティで、マイクを既定値に設定する（マイクの表示がない場合には右クリックをして無効なデバイスの表示および切断されているデバイスの表示にチェックを入れて下さい。）<br>
・上の画面にあるボリュームのコントロールは、「恋声」を実行後にボリューム調整のために使用するので下の作業が終わったらまた開いておく。<br>
・再生デバイス→スピーカー→プロパティ→レベルを選択して、マイクをミュートする（スピーカーのアイコンをクリックするとミュートのアイコンに変わる）<br>
・この状態でマイクに向かって話した声がヘッドフォンから聴こえないことを確認して下さい。（聴こえたらミュートがされていない）<br>
<br>
(以下、XP/Vista共通）<br>
　次に、koigoe.exeをダブルクリックして「恋声」を起動します。<br>
　「方式の選択」で、TD-PSOLAを選択して下さい。<br>
　次に「入力」の欄の中の「マイクのアイコンのボタン」を押して下さい。この状態でマイクに話した声が一瞬の時間遅れてヘッドフォンから聴こえるはずです。レベルメーターが表示されていますので、緑から黄色の範囲になるようにWindowsの録音のボリュームを調整して下さい。<br>
　もし音声が聴こえなかったら、STOPボタンを押した後にThruにチェックを入れて再度マイクのボタンを押して下さい。Thruでもマイクからの声が聴こえない場合は、Windowsの録音デバイスの設定が正しくないと思われます。<br>
<br>
　音声が正しく聴こえたら、、男性の場合は「M→W」、女性の場合は「W→M」のボタンを押して下さい。これで男声から女声へ、あるいは女声から男声に変わるはずです。「M→W」「W→M」のボタンではピッチを２倍、フォルマントを1.4倍に変化させます。これ以外の値にする場合には、PitchあるいはFormantのスライダーを動かして調節して下さい。<br>
<br>
　マイクボタンを押す前に「出力音声をファイルに保存する」のチェックを入れておくと、ピッチ変換したwavデータを同時に保存します。保存先は<a href="koigoe6.html">「設定」</a>で指定したフォルダで、ファイル名はsave_xxxx.wavです。xxxxの所は、0000から9999までの数字が入ります。安全を考慮して、容量が100MB(20分)を超えたら保存を自動的に終了します。<br>
<br>
<br>
<b>【使い方２ 〜ファイル入力の場合〜】</b><br>
<br>
　「入力」の欄の中の「ファイルのアイコンのボタン」を押して下さい。ファイルを聞いてきますので、再生するwavファイルを指定して下さい。「恋声」単独で読み込めるwavファイルの形式は、44.1kHz,                              
16bit のみです。しかし、EcoDecoTooLがインストールされている場合には、任意の形式のwavファイル、およびmp3/mp4/aac/flv等のEcoDecoTooLが変換できるすべてのファイル形式を使用することができます。詳しく<a href="koigoe6.html">こちら</a>参照。ファイルのドラッグ＆ドロップにも対応しているので、ファイルをドラッグして「恋声」のウィンドウにドロップしても再生できます。<br>                          
<br>
　マイク入力時と同様に、「M→W」あるいは「W→M」あるいはPitch,                            
Formantのスライダを調整して音質を調整して下さい。<br>
<br>
　事前に「出力音声をファイルに保存する」のチェックを入れておくと、ピッチ変換したwavデータを同時に保存します。保存先は<a href="koigoe6.html">「設定」</a>で指定したフォルダで、ファイル名は「元のファイル名＋_xx.wav」です。xxの所は、01から99までの数字が入ります。<br>
<b><br>
</b>
<br>
<b>【声の高さと性質の調整】</b><br>
<br>
　ピッチ(Pitch)は声の高さのことです。100% (0)           
が元の声の高さです。右に動かすと高くなり、左に動かすと低くなります。%表示は周波数が元の何%になっているかを示します。()の中の数字は半音を1とした時の変化量で、+1は半音高く、-1は半音低いことを示しています。<br>
　フォルマント(Formant)は声の性質のことです。100% (0)           
が元のフォルマントです。右に動かすとフォルマント周波数が上がり女声的、幼児的になります。左に動かすと男声的、モンスター声的になります。%表示はフォルマント周波数が元の何%になっているかを示します。()の中の数字は半音を1とした時の変化量で、+1は半音高く、-1は半音低いことを示しています。<br>
<br>
<br>
<b>【Preset】<br>
<br>
</b>　「M→W」を押すと、標準的な男声から女声への変換の設定値が入ります。<br>
　「W→M」を押すと、標準的な女声から男声への変換の設定値が入ります。<br>
　「Reset」のボタンをクリックすると、男声、女声両方をカバーする変換の標準的な設定値が入ります。<br>
<br>
　数字の「1」〜「4」のボタンをCtrlキーを押しながらマウスでクリックすると、現在の以下の値を保存します。<br>
　　・ Pitch<br>                           
　　・ Formant<br>                           
　　・ ボーカル音域Min<br>                           
　　・ ボーカル音域Max<br>                           
　　・ Pitch Analyzerの表示下限音<br>                           
　　・ Corr thresh<br>                           
　次回からは、「1」〜「4」のボタンをマウスでクリックするだけで、保存した内容に設定できます。<br>
<br>
<br>
<b>【ボーカルの音域の設定】</b><br>
<br>
　入力する音声のピッチの下限と上限を指定します。入力ピッチはこの範囲内であると仮定しますので、範囲外のピッチが入力されると別のピッチと誤認されますので注意して下さい。<br>
　<font color="#FF0000">ボーカルの音域の設定は非常に重要です。変換がうまくいかない場合には、この値を変えて試してみてください。</font><br>
<br>
<br>
<b>【Corr threshの設定】</b><br>     
<br>
　これは、初期値の0.5のままで、あまりいじる必要はありません。<br>
<br>
<br>
<b>【Pitch Analyzer】</b><br> 
<br>
　TD-PSOLA選択時に、TD-PSOLAが検出したピッチを緑色のグラフで表示します。停止後にスクロールバーを動かすことにより、すべての時間のピッチを見ることができます。表示は約７分間が限度で、これを過ぎると「Buffer                              
full」の表示が出て止まります。表示が止まってもピッチ変換は続けて行っています。<br>
　<a href="koigoe6.html">「設定」</a>で音量表示にチェックが入っている場合には同時に青色で音量を表示します。<br>
<br>
<br>
<b>【Dump機能】</b><br>
<br>
　「Dump」のチェックボックスにチェックを入れておくと、「恋声」が解析したピッチをテキストファイルとして保存します。保存先は<a href="koigoe6.html">「設定」</a>で指定したフォルダで、ファイル名はdump_xxxx.txtです。xxxxの所は、0000から9999までの数字が入ります。<br>
<br>
<br>
<b>【Chorus file】</b><br>   
<br>
　Dump機能で出力したファイルを編集してコーラスの音を指定することができます。例えば、Chorusの欄に-5と書き込むと、完全５度下の音を重ねて出力します。数字は元の音から半音でいくつ離れているかです。負の場合には下の音を、正の場合には上の音を重ねます。値の範囲は-64〜64で小数の入力も可能です。このようにして記述したファイルを「Chorus                              
file」のボタンを押して指定します。ファイルの編集にはExcelを使うと楽です。（0は同じ音を重ねます。127と入力すると音を重ねません。）　コーラスファイルの記述のについては、末尾の補足参照。<br>
<br>
<br>
<b>【ThruとOriginal】</b><br>
<br>
　Thruは、処理を行わないで入力をそのまま出力します。<br>
　Originalは、処理は普通に行っているが入力と同じ音声を出力します。変換音声と入力音声を聴き比べたり、ピッチ解析・周波数解析結果だけを見るのに使えます。<br>
<br>
<br>
<b>【バッチ処理】<br>
</b><br>
　「Batch」のボタンを押すと、音声出力を行わないで変換だけを行います。結果は、<a href="koigoe6.html">「設定」</a>で指定したフォルダに、save_xxxx.wavというファイル名で保存されます。xxxxの所は、0000から9999までの数字が入ります。このバッチ処理では<a href="koigoe6.html">「設定」</a>で指定した数(1,2,4)のオーバーサンプリングを行って処理を行います。また、wavファイル全体でピッチ／フォルマント変換を行います。この２つの理由により、「恋声」の中で最も精度の高い変換が行われます。（但し、時間が掛かる、大きなファイルを扱おうとするとメモリ不足のエラーが発生する、といったことがあります。）<br>
<br>
　「平坦化」および「Dump」はバッチ処理と組み合わせて使用することができます。　<br>
　「平坦化」と「Dump」の両方のチェックが入っている場合には、Dumpファイル内のコーラス値に平坦化を行う値が入ります。<br>
<br>
<b><br>
【方式選定・特殊効果】
</b><br>
<br>
<b>歌声<br>
</b>　この方式では、ピッチ変換の正確さを優先します。まれに入出力のデータ数にずれが発生して、以前の音が部分的に混入して聞こえる等の問題が発生する場合があります。その場合は、一度停止のボタンを押して再びマイクのボタンを押して下さい。<br>
<br>
<b>話声</b><br>
　この方式では、変換前後のデータ数をその都度一致させます。だから「歌声」のような破綻は起きません。しかし、変換後の音程が正確ではなく音痴のように聞こえる場合があります。話し声なら音程のずれは問題にならないでしょう。原因が分かっていませんが、「話声」でも音声が途切れる場合があります。その場合は、一度停止のボタンを押して再びマイクのボタンを押して下さい。<br>
<br>
<b>３度上を重ねる<br>
</b>　長三度上の音を重ねて出力します。一人で歌っているのに、二人でコーラスしているように聴こえます。<br>
<br>
<b>平坦化</b><br>
　常に一定のピッチで出力します。一定となるピッチは、ピッチのスライダーが            
100% (0) の場合にボーカル音域の中央のピッチになります。<br>         
　ピッチとフォルマントのスライダーを動かして、声の性質を変えることもできます。<br>
　ピッチのスライダーを動かすと、一定となるピッチも変化します。<br>
<br>
<b>正弦波</b><br>
　検出したピッチと音量に基づいて正弦波で音声を出力します。<br>
<br>
<b>方形波</b><br>
　検出したピッチと音量に基づいて方形波で音声を出力します。<br>
<br>
<b>鋸波</b><br>
　検出したピッチと音量に基づいて鋸波で音声を出力します。<br>
</p>
<p>　</p>
<p><b>--- 補足 ---</b></p>           
<p><b>Chorus fileのフォーマット</b><br>         
<table border="0" width="72%">
  <tbody>
    <tr>
      <td width="13%">koigoe</td>
      <td width="13%">2.72</td>
      <td width="12%"></td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="13%">Input</td>
      <td width="13%">sample.wav</td>
      <td width="12%"></td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="13%">OverSampling</td>
      <td width="13%">1</td>
      <td width="12%"></td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="13%">A4</td>
      <td width="13%">440</td>
      <td width="12%"></td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="13%">MinKey</td>
      <td width="13%">G_3</td>
      <td width="12%">19</td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="13%">MaxKey</td>
      <td width="13%">E_5</td>
      <td width="12%">40</td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="26%" colSpan="2">CorrThresh</td>
      <td width="12%">0.5</td>
      <td width="20%" colSpan="2"></td>
      <td width="9%"></td>
      <td width="50%"></td>
    </tr>
    <tr>
      <td width="26%" colSpan="2">PitchShiftEnable</td>
      <td width="12%"><font color="#0000ff"><b>1</b></font></td>
      <td width="79%" colSpan="4"><font color="#ff0000">0:オリジナルの音声を使用（ピッチ変更不可）　1:ピッチ変更可</font></td>
    </tr>
    <tr>
      <td width="26%" colSpan="2">MixingLevel_Original</td>
      <td width="12%"><font color="#0000ff"><b>1.0</b></font></td>
      <td width="79%" colSpan="4"><font color="#ff0000">オリジナル音声のレベル（1.0は入力と同じレベル）</font></td>
    </tr>
    <tr>
      <td width="26%" colSpan="2">MixingLevel_Chorus</td>
      <td width="12%"><font color="#0000ff"><b>0.5</b></font></td>
      <td width="79%" colSpan="4"><font color="#ff0000">コーラス音声のレベル</font></td>
    </tr>
    <tr>
      <td width="13%">Samples</td>
      <td width="13%">Time</td>
      <td width="12%">MaxAmp</td>
      <td width="10%">Hz</td>
      <td width="10%">&nbsp;Note</td>
      <td width="59%" colSpan="2">Chorus</td>
    </tr>
    <tr>
      <td width="13%">0</td>
      <td width="13%">0:00.000</td>
      <td width="12%">0</td>
      <td width="10%">0</td>
      <td width="10%">0</td>
      <td width="9%"><font color="#0000ff"><b>-5</b></font></td>
      <td width="50%"><font color="#ff0000">完全５度下</font></td>
    </tr>
    <tr>
      <td width="13%">441</td>
      <td width="13%">0:00.010</td>
      <td width="12%">9</td>
      <td width="10%">100</td>
      <td width="10%">0</td>
      <td width="9%"><font color="#0000ff"><b>-5</b></font></td>
      <td width="50%"><font color="#ff0000">完全５度下</font></td>
    </tr>
    <tr>
      <td width="13%">882</td>
      <td width="13%">0:00.020</td>
      <td width="12%">12</td>
      <td width="10%">100</td>
      <td width="10%">0</td>
      <td width="9%"><font color="#0000ff"><b>-5</b></font></td>
      <td width="50%"><font color="#ff0000">完全５度下</font></td>
    </tr>
  </tbody>
</table>
<p><font color="#ff0000">注意：　上表で青字以外の値は絶対に修正しないこと。</font><br>
<br>
・Chorus値は小数値でも記述することができます。（例：   
-0.25　これは半音の1/4だけ下げることを意味します）<br>
・OverSamplingが4の場合には、Samplesの値は実際のWAVファイルのデータの4倍になります。<br>
・「平坦化」のチェックが入っている場合には、<br>
Samples　　　Time　　　MaxAmp　　　Hz　　　Note　　　Chorus(F_4)<br>
のように表示されます。Chorus(F_4) のF_4は、F_4に平坦化されるChorus値であることを示します。この値(F_4)は「恋声」で設定したボーカルの最低音と最高音の中央の音です。<br> 
</p>

</body>

</html>
